import { Red } from "../../../src";

const bin = Buffer.from([
  225, 15, 0, 63, 97, 104, 29, 208, 3, 229, 100, 178, 181, 120, 210, 6, 26, 63,
  88, 4, 202, 114, 88, 47, 248, 131, 53, 242, 84, 122, 134, 206, 16, 87, 131,
  234, 51, 221, 129, 140, 225, 63, 226, 208, 120, 116, 106, 20, 10, 249, 73, 2,
  61, 25, 68, 227, 141, 50, 78, 101, 154, 169, 3, 98, 245, 13, 85, 101, 104, 27,
  123, 174, 111, 77, 149, 222, 113, 40, 46, 234, 198, 124, 168, 82, 102, 226,
  57, 199, 228, 196, 185, 218, 186, 217, 221, 186, 160, 126, 182, 107, 220, 62,
  55, 2, 213, 131, 220, 216, 47, 239, 131, 139, 188, 25, 246, 91, 24, 61, 132,
  81, 243, 252, 225, 123, 99, 43, 242, 142, 217, 186, 48, 225, 252, 195, 205,
]);

describe("Red", () => {
  it("serialize/deserialize", () => {
    const dec = Red.deSerialize(bin);
    expect(dec.header.fields).toEqual([
      {
        fBit: 1,
        blockPT: 97,
        timestampOffset: 960,
        blockLength: 63,
      },
      {
        fBit: 0,
        blockPT: 97,
      },
    ]);
    const enc = dec.serialize();
    expect(enc).toEqual(bin);
  });
});
